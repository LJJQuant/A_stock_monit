# Aè‚¡é¢„è­¦ç³»ç»Ÿ - å¼€å‘è¿›åº¦è¡¨

> è®°å½•æ¯ä¸ªå¼€å‘æ­¥éª¤çš„å®Œæˆæ—¶é—´

---

## Phase 1: åŸºç¡€è®¾æ–½ âœ…

| æ­¥éª¤ | ä»»åŠ¡ | å®Œæˆæ—¶é—´ | å¤‡æ³¨ |
|------|------|----------|------|
| 1.1 | ç›®å½•ç»“æ„ + requirements.txt | 2025.1.28 | åˆ›å»ºé¡¹ç›®éª¨æ¶ |
| 1.2 | é…ç½®ç®¡ç† | 2025.1.28 - 2025.2.1 | config_schema + config_generator + config + settings.yaml |
| 1.3 | å¸¸é‡å®šä¹‰ | 2025.1.29 | constants.py |
| 1.4 | æ•°æ®åº“ç®¡ç† | 2025.1.29 | db.py + 4ä¸ªduckdbæ–‡ä»¶ |

---

## Phase 2: æ•°æ®å±‚ ğŸš§

| æ­¥éª¤ | ä»»åŠ¡ | å®Œæˆæ—¶é—´ | å¤‡æ³¨ |
|------|------|----------|------|
| 2.1 | ç±»å‹å®šä¹‰ + å¼‚å¸¸ | 2025.2.1 | src/data/types.py, source/exceptions.py |
| 2.2 | æ˜é‡‘SDKå°è£… | 2025.2.1 | src/data/source/juejin_client.py |
| 2.3 | äº¤æ˜“æ—¥å†ä»“åº“ | 2025.2.1 | repository/trading_calendar.py |
| 2.4 | è‚¡ç¥¨æ± ä»“åº“ | 2025.2.1 | repository/stock_pool.py |
| 2.5 | Kçº¿ä»“åº“ | 2025.2.2 | repository/kline.py |
| 2.6 | Kçº¿åŒæ­¥æœåŠ¡ | 2025.2.2 | service/kline_sync.py, æ”¯æŒæ–­ç‚¹ç»­ä¼  |
| 2.7 | Kçº¿åˆå§‹åŒ– | 2025.2.2 | scripts/init_kline.py, 4902åªè‚¡ç¥¨å®Œæˆ |
| 2.8 | æŸ¥è¯¢å±‚é‡æ„ | 2025.2.2 | query/kline_query.py, calendar_query.py, stock_query.py |
| 2.9 | å¢é‡æ›´æ–° | - | **å¾…åš**: æ¯æ—¥å¢é‡æ›´æ–°é€»è¾‘å·²å†™å¥½ï¼Œå¾…æµ‹è¯• |
| 2.10 | daily_sync æ•´åˆ | - | **å¾…åš**: æŠŠKçº¿å¢é‡æ›´æ–°åŠ å…¥ daily_sync.py |

### å½“å‰æ–‡ä»¶ç»“æ„
```
src/data/
â”œâ”€â”€ types.py              # ç±»å‹å®šä¹‰
â”œâ”€â”€ source/               # æ•°æ®æº
â”‚   â”œâ”€â”€ juejin_client.py  # æ˜é‡‘SDKå°è£…
â”‚   â””â”€â”€ exceptions.py     # å¼‚å¸¸å®šä¹‰
â”œâ”€â”€ repository/           # ä»“åº“å±‚ï¼ˆå­˜å‚¨ï¼‰
â”‚   â”œâ”€â”€ base.py
â”‚   â”œâ”€â”€ trading_calendar.py
â”‚   â”œâ”€â”€ stock_pool.py
â”‚   â””â”€â”€ kline.py
â”œâ”€â”€ query/                # æŸ¥è¯¢å±‚ï¼ˆä¸šåŠ¡æŸ¥è¯¢ï¼‰
â”‚   â”œâ”€â”€ kline_query.py
â”‚   â”œâ”€â”€ calendar_query.py
â”‚   â””â”€â”€ stock_query.py
â””â”€â”€ service/              # æœåŠ¡å±‚ï¼ˆåŒæ­¥ç­‰ï¼‰
    â””â”€â”€ kline_sync.py
```

### æ•°æ®çŠ¶æ€
- äº¤æ˜“æ—¥å†: 2022-01-01 ~ 2026-08-02ï¼ˆå·²åŒæ­¥ï¼‰
- è‚¡ç¥¨æ± : 5302 åªï¼ˆå·²åŒæ­¥ï¼‰
- Kçº¿æ•°æ®: 2023-01-01 ~ 2026-01-01ï¼Œ4882 åªå®Œæˆï¼Œ20 åªå¤±è´¥å¾…è¡¥å……

---

## Phase 3: æŒ‡æ ‡ä¸æ¡ä»¶è®¡ç®—

| æ­¥éª¤ | ä»»åŠ¡ | å®Œæˆæ—¶é—´ | å¤‡æ³¨ |
|------|------|----------|------|
| 3.1 | KDJ/MA/VWAP æŒ‡æ ‡ | - | |
| 3.2 | 20ä¸ªé¢„è­¦æ¡ä»¶ | - | |
| 3.3 | ä¿¡å·å¼•æ“ | - | |

---

## Phase 4-7: å¾…è§„åˆ’

åç»­é˜¶æ®µå®Œæˆæ—¶æ›´æ–°ã€‚

---

## æ˜æ—¥å¾…åŠ

1. **è¿è¡Œ `retry_failed()`** è¡¥å…… 20 åªå¤±è´¥è‚¡ç¥¨
2. **æµ‹è¯•å¢é‡æ›´æ–°** - è¿è¡Œ `incremental_sync()` éªŒè¯å¢é‡é€»è¾‘
3. **æ•´åˆ daily_sync.py** - åŠ å…¥ K çº¿å¢é‡æ›´æ–°
4. **æµ‹è¯•æŸ¥è¯¢æ¥å£** - éªŒè¯ KlineQuery, CalendarQuery, StockQuery

---

## å¸¸ç”¨å‘½ä»¤

```python
# Kçº¿åˆå§‹åŒ–è„šæœ¬ (scripts/init_kline.py)
show_status()   # æŸ¥çœ‹çŠ¶æ€
reset()         # é‡ç½®è¿›åº¦
init()          # å¼€å§‹åˆå§‹åŒ–
retry_failed()  # è¡¥å……å¤±è´¥çš„è‚¡ç¥¨

# æŸ¥è¯¢ç¤ºä¾‹
from src.data.query import KlineQuery, CalendarQuery, StockQuery

kq = KlineQuery()
df = kq.get_kline("SHSE.600000", "2024-01-01", "2024-06-30")
df = kq.get_kline_by_date("2024-01-15")

cq = CalendarQuery()
days = cq.get_trading_days("SHSE", "2024-01-01", "2024-06-30")

sq = StockQuery()
symbols = sq.get_symbols("main")
```
